---
title: "Procedural Map Validation System"
description: "절차적 생성 기법에 공정성 검증 규칙을 자동화한 FPS 맵 생성 시스템. QGIS 기반 수동 분석을 Python으로 구현하여 팀 간 시야 노출 균형을 정량적으로 검증"
pubDate: 2025-10-04
category: "Side Projects"
tags: ["Python", "Procedural Generation", "Spatial Analysis", "Game Development", "Automation"]
---

**GitHub Repository**: https://github.com/vanillapapaya/Procedural-map-validation-system

## 프로젝트 배경

이전 회사에서 FPS 맵 분석을 진행할 때 QGIS를 사용하여 팀 간 시야 노출 균형을 수동으로 계산했습니다. 이 과정은 효과적이었지만 시간이 오래 걸렸고, 맵마다 반복적으로 동일한 작업을 수행해야 했습니다.

이 프로젝트는 두 가지 목표를 위해 시작했습니다. 첫째, 절차적 생성 기법에 공정성 검증 규칙을 자동으로 적용하여 균형잡힌 맵만 생성하는 시스템을 만들고자 했습니다. 둘째, QGIS에서 수동으로 진행하던 계산을 Python으로 자동화하여 분석 속도를 높이고자 했습니다.

## 현재의 한계와 개선 방향

현재 시스템은 계산량이 매우 많아 작은 맵에서도 생성 시간이 오래 걸립니다. 64x64 맵의 전수 조사는 약 200만 회의 Line-of-Sight 체크를 수행하며 2-5분이 소요됩니다. 더 큰 맵은 계산 시간이 기하급수적으로 증가합니다.

이를 해결하기 위해 계산량을 줄이는 알고리즘이 필요합니다. NumPy 벡터화, 멀티프로세싱, 또는 Cython을 활용한 최적화를 고려 중입니다. 또한 GPU 가속을 통해 병렬 처리 성능을 대폭 향상시킬 수 있을 것으로 예상합니다.

현재 방식은 맵을 생성하고 검증한 후 기준에 맞지 않으면 폐기하는 구조입니다. 이는 비효율적입니다. 더 나은 접근은 생성 알고리즘 자체에 공정성 규칙을 제약 조건으로 포함시키는 것입니다. 예를 들어 Perlin noise 생성 시 팀 존 경계에서의 고도 차이를 제한하거나, 특정 지형 패턴을 강제하여 불균형한 맵이 애초에 만들어지지 않도록 할 수 있습니다.

## 향후 활용 계획

이 시스템으로 생성된 수치 표고 모델은 Unreal Engine에 직접 가져올 수 있습니다. Heightmap을 PNG 또는 RAW 형식으로 내보내면 Unreal의 Landscape 시스템이 이를 인식하여 3D 지형으로 변환합니다. 이를 통해 Python에서 검증된 맵을 실제 게임 엔진에서 플레이 가능한 레벨로 빠르게 만들어볼 수 있습니다.

이 과정은 레벨 디자이너의 작업을 크게 단축시킬 수 있습니다. 수십 개의 균형잡힌 맵을 자동으로 생성하고, 그 중 가장 흥미로운 것을 선택하여 Unreal Engine에서 세부 디테일을 추가하는 방식으로 진행할 수 있습니다. 이는 순수 수작업보다 훨씬 빠르고, 순수 절차적 생성보다 품질이 높습니다.

## 생성 결과물

![원본 지형](/images/step1_raw_heightmap.png)

Perlin noise로 생성된 원본 heightmap입니다. 밝을수록 높은 고도를 나타냅니다.

![팀 존 할당](/images/step2_team_zones.png)

맵을 Team A와 Team B 영역으로 구분한 결과입니다. 파란색과 빨간색으로 각 팀의 구역이 표시됩니다.

![샘플 포인트 배치](/images/step3_sample_points.png)

각 팀 존에서 선택된 관찰자와 타겟 포인트의 위치입니다. 이 포인트들을 기준으로 시야 분석을 수행합니다.

![Line-of-Sight 계산](/images/step4_line_of_sight.png)

특정 관찰자에서 타겟까지의 시야선을 그리고 지형에 의한 차단 여부를 확인한 결과입니다.

![노출도 분석](/images/step5_exposure_calculation.png)

각 픽셀의 노출도를 색상으로 표현한 히트맵입니다. 붉은색은 높은 노출(위험), 파란색은 낮은 노출(안전)을 의미합니다.
