## 실무 활용 가능성

검증을 통과한 맵의 heightmap은 PNG 또는 RAW 형식으로 내보내 Unreal Engine의 Landscape 시스템에 직접 가져올 수 있습니다. Python에서 균형이 검증된 지형을 게임 엔진에서 플레이 가능한 레벨로 빠르게 변환할 수 있다는 뜻입니다.

이 워크플로우는 레벨 디자이너에게 유용할 수 있습니다. 여러 후보 맵을 자동으로 생성하고 검증한 뒤, 그 중 가장 흥미로운 것을 선택하여 Unreal Engine에서 세부 디테일을 추가하는 방식입니다. 순수 수작업보다 빠르고, 무작위 생성보다는 품질 통제가 가능합니다.---
title: "Automated FPS Map Balance Validation System"
description: "QGIS 수동 분석을 Python으로 자동화하여 랜덤 생성된 맵의 팀 간 시야 균형을 정량적으로 검증하는 시스템"
pubDate: 2025-10-04
category: "Side Projects"
tags: ["Python", "Spatial Analysis", "Game Development", "Automation", "Line-of-Sight"]
---

**GitHub Repository**: https://github.com/vanillapapaya/Procedural-map-validation-system

## 프로젝트 배경

이전 회사에서 FPS 맵 분석을 진행할 때 QGIS를 사용하여 팀 간 시야 노출 균형을 수동으로 계산했습니다. 이 과정은 효과적이었지만 시간이 오래 걸렸고, 맵마다 반복적으로 동일한 작업을 수행해야 했습니다.

이 프로젝트는 QGIS에서 수동으로 진행하던 시야 분석을 Python으로 완전히 자동화하는 것을 목표로 시작했습니다. Perlin noise로 랜덤하게 생성된 지형에 대해 팀 간 시야 노출 균형을 자동으로 측정하고, 공정성 기준에 맞는 맵만 선별하는 검증 시스템을 구축했습니다.

## 현재 구현과 한계

현재 시스템은 Perlin noise로 생성된 랜덤 지형을 받아서 팀 존을 할당하고, 각 팀 영역에서 샘플 포인트를 추출한 뒤 모든 가능한 조합에 대해 Line-of-Sight 계산을 수행합니다. 64x64 맵의 경우 약 200만 회의 시야선 체크가 필요하며 2-5분이 소요됩니다.

이 방식의 핵심 한계는 생성과 검증이 분리되어 있다는 점입니다. 맵을 먼저 랜덤하게 만들고, 검증 후 기준에 맞지 않으면 폐기하는 구조입니다. 균형잡힌 맵을 얻기 위해 수십 개를 생성하고 버려야 할 수 있습니다.

## 향후 개선 방향

첫 번째 개선 과제는 성능 최적화입니다. NumPy 벡터화, 멀티프로세싱, Cython 또는 GPU 가속을 통해 계산 시간을 단축할 수 있을 것으로 예상합니다. 64x64 맵을 2-5분이 아닌 수 초 내에 검증할 수 있다면 실시간 피드백이 가능해집니다.

두 번째는 진짜 절차적 생성으로의 진화입니다. 현재는 검증만 자동화되어 있지만, 장기적으로는 생성 알고리즘 자체에 공정성 규칙을 제약 조건으로 포함시키고 싶습니다. 예를 들어 Perlin noise 생성 시 팀 존 경계에서의 고도 차이를 제한하거나, 전략적 요충지를 의도적으로 배치하여 불균형한 맵이 애초에 만들어지지 않도록 하는 것입니다. 이렇게 되면 생성-폐기 방식이 아니라 처음부터 균형잡힌 맵만 생성하는 진정한 절차적 생성 시스템이 될 것입니다.

## 생성 결과물

![원본 지형](/images/step1_raw_heightmap.png)

Perlin noise로 생성된 원본 heightmap입니다. 밝을수록 높은 고도를 나타냅니다.

![팀 존 할당](/images/step2_team_zones.png)

맵을 Team A와 Team B 영역으로 구분한 결과입니다. 파란색과 빨간색으로 각 팀의 구역이 표시됩니다.

![샘플 포인트 배치](/images/step3_sample_points.png)

각 팀 존에서 선택된 관찰자와 타겟 포인트의 위치입니다. 이 포인트들을 기준으로 시야 분석을 수행합니다.

![Line-of-Sight 계산](/images/step4_line_of_sight.png)

특정 관찰자에서 타겟까지의 시야선을 그리고 지형에 의한 차단 여부를 확인한 결과입니다.

![노출도 분석](/images/step5_exposure_calculation.png)

각 픽셀의 노출도를 색상으로 표현한 히트맵입니다. 붉은색은 높은 노출(위험), 파란색은 낮은 노출(안전)을 의미합니다.
